<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="/style/style-nav.css">
    <link rel="stylesheet" href="/style/main_page.css">
    <link rel="stylesheet" href="/style/create_team.css">
    <meta name="viewport"
    content="width=device-width, initial-scale=1.0">
</head>
<!-------------------------- NAVIGACE -------------------------------->
<body>
  <% if(!userLogged) { %>
    <header>
      <img src="/images/logo.png" onclick=HomePage() alt="logo" class="logo" width="200" height="50">
      <input type="checkbox" id="nav-toggle" class="nav-toggle">
      <nav>
        <ul>
          <li><a href="/">Dom콢</a></li>
          <li><a href="/faculty">Naj칤t t칳m</a></li>
          <li><a href="/register">칔캜et</a></li>
        </ul>
      </nav>
      <label for="nav-toggle" class="nav-toggle-label"><span></span></label>
    </header>

    <% } if(userLogged) { %>
      <header>
        <img src="/images/logo.png" onclick=HomePage() alt="logo" class="logo" width="200" height="50">
        <input type="checkbox" id="nav-toggle" class="nav-toggle">
        <nav>
          <ul>
            <li><a href="/">Dom콢</a></li>
            <li><a href="/subject/<%=userFaculty%>">Naj칤t t칳m</a></li>
            <li><a href="/my_profile">칔캜et</a>
              <ul class="dropdown" id="dropdown">
                <li><a class="dropdown_item" href="/my_profile">M콢j 칰캜et</a></li>
                <li><a class="dropdown_item" href="/team/myTeams">Moje t칳my</a></li>
                <li><a class="dropdown_item" data-method="delete" href="/logout">Odhl치sit se</a></li>
              </ul>
            </li>
          
      <!-- NOTIFIKACNI LISTA START -->
          <li><a id="notif" href="#">Notifikace</a>
            <ul class="dropdown-news" id="dropdown-news">
              <form id="notifForm">
                <button type="submit" class="clear-btn_index">Vy캜istit</button>
              </form>
              <%notification.forEach((notifi, index)=> {%>
                <p class="dropdown_item-news dropdown_item-time">
                  <%= notifi.createdAt %>
                </p>
                <p class="dropdown_item-news">
                  <%= notifi.notification %>
                </p>
                <%})%>
            </ul>
          </li>

          <script>
            async function notification(event) {
              const response = await fetch("/notification/deleteAll", {
                method: "POST",
                redirect: 'follow',
                headers: {
                  'Accept': 'application/json',
                  'Content-Type': 'application/json'
                },
              });
              if (response) {
                let error = await response.json()
                alert(error.message);
              }
              window.location.href = ''
            }

            const notifiForm = document.querySelector('#notifForm');
            notifiForm.addEventListener('submit', notification);
          </script>
      <!-- NOTIFIKACNI LISTA END -->
        </ul>
      </nav>
      
      
      <label for="nav-toggle" class="nav-toggle-label"><span></span></label>
      <!-- NOTIFIKACNI LISTA START (mobilni) -->
      <input type="checkbox" id="nav-toggle_notify" class="nav-toggle_notify">
      <label for="nav-toggle_notify" class="nav-toggle-label_notify"><span>游댒</span></label>
      <nav class="nav_notify">
        <ul class="dropdown-news" id="dropdown-news">
          <a id="notif" href="#"></a>
          <form id="notifFormMobil">
            <button type="submit" class="clear-btn_index">Vy캜istit</button>
          </form>
          <%notification.forEach((notifi, index)=> {%>
            <p class="dropdown_item-news dropdown_item-time">
              <%= notifi.createdAt %>
            </p>
            <p class="dropdown_item-news">
              <%= notifi.notification %>
            </p>
            <%})%>
        </ul>
      </nav>

      <script>
        async function notification(event) {
          const response = await fetch("/notification/deleteAll", {
            method: "POST",
            redirect: 'follow',
            headers: {
              'Accept': 'application/json',
              'Content-Type': 'application/json'
            },
          });
          if (response) {
            let error = await response.json()
            alert(error.message);
          }
          window.location.href = ''
        }
        const notifiFormMobile = document.querySelector('#notifFormMobil');
        notifiFormMobile.addEventListener('submit', notification);
      </script>
      <!-- NOTIFIKACNI LISTA END (mobilni) -->
    </header>
    <% } %>
<!-------------------------- KONEC NAVIGACE -------------------------------->

    <div class="hero">
      <div class="form-box">
        <form id="edit" class="input-group">
          <h2 class="nadpis">Vytvo콏it t칳m</h2>
          <input type="text" class="input-field" name="name" autocomplete="off" minlength="4" maxlength="30" pattern="^[캩코캜콏쮂쫚뫆솪뽞칰콢캞콘켿캝켾콗먟꺤떈쫚롺칈칄칔콡캨칍a-zA-z0-9]+[캩코캜콏쮂쫚뫆솪뽞칰콢캞콘켿캝켾콗먟꺤떈쫚롺칈칄칔콡캨칍a-zA-z0-9 ]*[캩코캜콏쮂쫚뫆솪뽞칰콢캞콘켿캝켾콗먟꺤떈쫚롺칈칄칔콡캨칍a-zA-z0-9_-]+$" placeholder="N치zev t칳mu" required>
          <input type="number" class="input-field" name="maxNumOfMem" autocomplete="off" min="2" max="10" placeholder="C칤lov칳 po캜et 캜len콢" required>
          <input type="text" class="input-field" name="briefDescription" autocomplete="off" maxlength="100" placeholder="Stru캜n칳 popis" required>
          <input type="textarea" class="input-field" name="hashtags" autocomplete="off" maxlength="30" placeholder="Kl칤캜ov치 slova">
          <div class="select">
            <select name="workingHours" class="selOptions" required>
              <option value="" disabled selected hidden>Preferovan치 doba pr치ce</option>
              <option value="1">brzy r치no</option>
              <option value="2">dlouho do noci</option>
              <option value="3">b캩hem dne</option>
            </select>
            <select name="workingDays" class="selOptions" required>
              <option value="" disabled selected hidden>Preferovan칠 dny pr치ce</option>
              <option value="1">za캜치tek t칳dne</option>
              <option value="2">konec t칳dne</option>
              <option value="3">v칤kend</option>
            </select>
            <select name="approach" class="selOptions" required>
              <option value="" disabled selected hidden>P콏칤stup k pr치ci</option>
              <option value="1">t칳mov칳</option>
              <option value="2">individu치ln칤</option>
            </select>
            <select name="partOfSemester" class="selOptions" required>
              <option value="" disabled selected hidden>Preferovan치 캜치st semestru</option>
              <option value="1">1. - 3. t칳den</option>
              <option value="2">4. - 6. t칳den</option>
              <option value="3">7. - 9. t칳den</option>
              <option value="4">10. - 13. t칳den</option>
            </select>
          </div>
          <input name="subject" value="<%=subject%>" hidden>
          <input name="faculty" value="<%=faculty%>" hidden>


          <button type="submit" class="submit-btn">Zalo쬴t t칳m</button>
        </form>
      </div>
    </div>
    
    
</body>

<script>
  async function fetchLocation(event) {
    event.preventDefault();
    const data = new FormData(event.target);
    const value = JSON.stringify(Object.fromEntries(data))

    const response = await fetch("createTeam", {
      method: "POST",
      redirect: 'follow',
      headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
      },
      body: value
    });
    if (response.status > 400) {
      let error = await response.json()
      alert(error.message);
    }
    else
      window.location.href = response.url
  }

  const form = document.querySelector('#edit');
  form.addEventListener('submit', fetchLocation);
</script>

<script src="/script/app.js"></script>
</html>